<!DOCTYPE html>
<html lang="en">
<head>
  {{ template "header" . }}
  <title>Sampling Request</title>
  <style>
    * {
      box-sizing: border-box;
    }

    input[type=text], select, textarea {
      width: 100%;
      padding: 12px;
      border: 1px solid #ccc;
      border-radius: 4px;
      resize: vertical;
    }

    label {
      padding: 12px 12px 12px 60px;
      display: inline-block;
    }

    input[type=submit] {
      background-color: #04AA6D;
      color: white;
      padding: 12px 20px;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      float: right;
    }

    input[type=submit]:hover {
      background-color: #45a049;
    }

    /*.container {*/
    /*  border-radius: 5px;*/
    /*  background-color: #f2f2f2;*/
    /*  padding: 20px;*/
    /*}*/

    .col-25 {
      float: left;
      width: 25%;
      margin-top: 6px;
    }

    .col-75 {
      float: left;
      width: 75%;
      margin-top: 6px;
    }

    /* Clear floats after the columns */
    .row:after {
      content: "";
      display: table;
      clear: both;
    }

    /* Responsive layout - when the screen is less than 600px wide, make the two columns stack on top of each other instead of next to each other */
    @media screen and (max-width: 600px) {
      .col-25, .col-75, input[type=submit] {
        width: 100%;
        margin-top: 0;
      }
    }
  </style>
</head>
<body>
  {{ template "navigation" . }}
  <div class="container">
      <div>
          <button type="button" class="btn btn-info"><a href="samplingsummary">SAMPLING SUMMARY</a></button>
          <button type="button" class="btn btn-success"><a href="samplingrequest">SAMPLING REQUEST</a></button>
      </div>
      <form action="/samplingrequest" method="post" class="container">
          <div class="row">
              <div class="col-25">
                  <label for="panda_name">采血个体（大熊猫姓名）</label>
              </div>
              <div class="col-75">
                  <input type="text" id="panda_name" readonly required>
                  <input type="hidden" id="PID" name="PID" >    <!-- server receives value-->
                  <input type="text" id="search" onkeyup="myFunction()" name="panda_name" placeholder="Searching giant panda by pedigree ID">
                  <!-- hidden list-->
                  <ul id="pandas">
                      {{ range .pandas }}
                          <li name="panda" id="{{ .PID }}" style="display: none" onclick="addValue({{ .PID }})">
                              <a href="#">{{ .PID }}:{{.Name}}</a>
                          </li>
                      {{ end }}
                  </ul>
              </div>
          </div>

          <div class="row">
              <div class="col-25">
                  <label>需求血量</label>
              </div>
              <div class="col-75 ">
                  <div class="col-25">
                      <label for="request_for_coagulation">不抗凝 (mL)</label>
                      <input type="text" id="request_for_coagulation" name="request_for_coagulation" value="0">
                  </div>
                  <div class="col-25">
                      <label for="request_for_heparin">肝素钠抗凝 (mL)</label>
                      <input type="text" id="request_for_heparin" name="request_for_heparin" value="0">
                  </div>
                  <div class="col-25">
                      <label for="request_for_edta">EDTA-K2抗凝 (mL)</label>
                      <input type="text" id="request_for_edta" name="request_for_edta" value="0">
                  </div>
                  <div class="col-25">
                      <label for="request_for_other">其他 (mL)</label>
                      <input type="text" id="request_for_other" name="request_for_other" value="0">
                  </div>
              </div>
          </div>
          <div class="row">
              <div class="col-25">
                  <label for="purpose">血样用途</label>
              </div>
              <div class="col-75">
                  <input type="text" id="purpose" name="purpose" placeholder="" required>
              </div>
          </div>
          <div class="row">
              <div class="col-25">
                  <label for="project">项目</label>
              </div>
              <div class="col-75">
                  <input type="text" id="project" name="project" placeholder="" required>
              </div>
          </div>
          <div class="row">
              <div class="col-25">
                  <label for="iacuc">IACUC编号</label>
              </div>
              <div class="col-75">
                  <input type="text" id="iacuc" name="iacuc" placeholder="">
              </div>
          </div>
          <div class="row">
              <div class="col-25">
                  <label for="project_manager">项目负责人</label>
              </div>
              <div class="col-75">
                  <input type="text" id="project_manager" name="project_manager" placeholder="" required>
              </div>
          </div>
          <div class="row">
              <div class="col-25">
                  <label for="contact">联系人</label>
              </div>
              <div class="col-75">
                  <input type="text" id="contact" name="contact" placeholder="" required>
              </div>
          </div>
          <div class="row">
              <div class="col-25">
                  <label for="notes">备注</label>
              </div>
              <div class="col-75">
                  <textarea id="notes" name="notes" placeholder="Write something.." style="height:200px"></textarea>
              </div>
          </div>
          <br>
          <div class="row">
              <input type="submit" value="Submit">
          </div>
    </form>
  </div>

  {{ template "footer" . }}

  <script>
      function myFunction() {
          var input, filter, ul, li, a, i, txtValue;
          input = document.getElementById("search");
          filter = input.value.toUpperCase();
          ul = document.getElementById("pandas");
          li = ul.getElementsByTagName("li");
          for (i = 0; i < li.length; i++) {
              a = li[i].getElementsByTagName("a")[0];
              txtValue = a.innerText;
              if (txtValue.toUpperCase().indexOf(filter) > -1 && filter != "") {
                  li[i].style.display = "";
              } else if (filter == "" || filter == undefined ) {
                  li[i].style.display = "none";
              } else {
                  li[i].style.display = "none";
              }
          }
      }

      let choosedPID = [];
      let choosedPanda = [];
      function addValue(id) {
          var li = document.getElementById(id);
          let a = li.getElementsByTagName("a")[0];
          if (choosedPID.includes(id) ){
              alert(a.innerText + " has existed");
          } else {
              choosedPID.push(id);
              choosedPanda.push(a.innerText);
              let input = document.getElementById("panda_name");
              input.value = choosedPanda.join("\t");
              document.getElementById("PID").value = choosedPID.join(",");
          }
      }
  </script>
</body>
</html>